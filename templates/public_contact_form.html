{% extends "base.html" %}

{% block title %}{{ form.form_title }}{% endblock %}

{% block content %}
<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      <div class="card shadow">
        <div class="card-header bg-primary text-white text-center">
          <h3 class="mb-0"><i class="fas fa-envelope"></i> {{ form.form_title }}</h3>
          {% if form.form_description %}
          <p class="mb-0 mt-2">{{ form.form_description }}</p>
          {% endif %}
        </div>
        <div class="card-body">
          {% if success %}
          <div class="alert alert-success text-center">
            <i class="fas fa-check-circle fa-2x mb-2"></i>
            <h5>Thank You!</h5>
            <p class="mb-0">{{ form.success_message }}</p>
          </div>
          <div class="text-center mt-3">
            <a href="/" class="btn btn-primary">
              <i class="fas fa-home"></i> Return Home
            </a>
          </div>
          {% else %}
          <form method="POST" id="contactForm">
            <div class="mb-3">
              <label for="name" class="form-label">Full Name *</label>
              <input type="text" class="form-control" id="name" name="name" required
                     placeholder="Enter your full name">
            </div>

            <div class="mb-3">
              <label for="email" class="form-label">Email Address *</label>
              <input type="email" class="form-control" id="email" name="email" required
                     placeholder="Enter your email address">
            </div>

            {% if form.require_phone %}
            <div class="mb-3">
              <label for="phone" class="form-label">Phone Number *</label>
              <input type="tel" class="form-control" id="phone" name="phone" required
                     placeholder="Enter your phone number">
            </div>
            {% else %}
            <div class="mb-3">
              <label for="phone" class="form-label">Phone Number</label>
              <input type="tel" class="form-control" id="phone" name="phone"
                     placeholder="Enter your phone number (optional)">
            </div>
            {% endif %}

            <div class="mb-3">
              <label for="message" class="form-label">Message</label>
              <textarea class="form-control" id="message" name="message" rows="4"
                        placeholder="Enter your message or inquiry (optional)"></textarea>
            </div>

            <div class="d-grid">
              <button type="submit" class="btn btn-primary btn-lg">
                <i class="fas fa-paper-plane"></i> Submit
              </button>
            </div>
          </form>
          {% endif %}
        </div>
        <div class="card-footer text-center bg-light">
          <small class="text-muted">
            <i class="fas fa-shield-alt"></i> Your information is secure and will only be used to contact you.
          </small>
        </div>
      </div>

      <!-- Additional Info Section -->
      <div class="card mt-4">
        <div class="card-body text-center">
          <h5><i class="fas fa-info-circle"></i> Need Help?</h5>
          <p class="text-muted mb-3">Our team is here to assist you with any questions or concerns.</p>
          <div class="row">
            <div class="col-md-6 mb-2">
              <a href="/" class="btn btn-outline-primary w-100">
                <i class="fas fa-home"></i> Home
              </a>
            </div>
            <div class="col-md-6 mb-2">
              <a href="/enhanced_events_analytics" class="btn btn-outline-info w-100">
                <i class="fas fa-chart-bar"></i> Analytics
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Form validation
  const form = document.getElementById('contactForm');
  if (form) {
    form.addEventListener('submit', function(e) {
      const requiredFields = form.querySelectorAll('input[required], textarea[required]');
      let isValid = true;
      
      requiredFields.forEach(field => {
        if (!field.value.trim()) {
          isValid = false;
          field.classList.add('is-invalid');
        } else {
          field.classList.remove('is-invalid');
        }
      });
      
      // Email validation
      const emailField = document.getElementById('email');
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (emailField.value && !emailRegex.test(emailField.value)) {
        isValid = false;
        emailField.classList.add('is-invalid');
      }
      
      if (!isValid) {
        e.preventDefault();
        alert('Please fill in all required fields correctly.');
      }
    });
    
    // Remove invalid class on input
    form.addEventListener('input', function(e) {
      if (e.target.classList.contains('is-invalid')) {
        e.target.classList.remove('is-invalid');
      }
    });
  }
});
</script>

<style>
.is-invalid {
  border-color: #dc3545;
}

.card {
  border: none;
  border-radius: 10px;
}

.card-header {
  border-radius: 10px 10px 0 0;
}

.btn {
  border-radius: 5px;
}

.form-control:focus {
  border-color: #0d6efd;
  box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
}
</style>
{% endblock %}
